:_mod-docs-content-type: ASSEMBLY
[id=ossm-migrating-cluster-wide-assembly]
= Cluster-wide migration guide
include::_attributes/common-attributes.adoc[]
:context: ossm-migrating-cluster-wide-assembly

toc::[]

This guide is for users who are running a cluster-wide deployment of {SMProductName} {SMv2Version} and are migrating to {SMProduct} 3.0.

[IMPORTANT]
====
You must complete the premigration checklists before you start migrating your deployment.
====

include::modules/ossm-control-plane-configuration-migration-requirements.adoc[leveloffset=+1]

include::modules/ossm-cluster-wide-migration-methods.adoc[leveloffset=+1]

// The following tasks are for migration using the Istio revision label
include::modules/ossm-migrating-a-cluster-wide-deployment-using-the-istio-revision-label.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources

* xref:../../install/ossm-sidecar-injection-assembly.adoc#ossm-identifying-revision-name_ossm-sidecar-injection-assembly[Identifying the revision name]

include::modules/ossm-migrating-workloads-using-the-istio-revision-label.adoc[leveloffset=+2]

include::modules/ossm-creating-a-default-revision-tag-and-relabeling-the-namespaces.adoc[leveloffset=+1]

.Next steps

You can proceed to complete the migration and remove {SMProduct} 2 resources.

* xref:../../migrating/done/ossm-migrating-complete-assembly.adoc[Completing the Migration]

// The following tasks are for migration using the Istio injection label
include::modules/ossm-migrating-a-cluster-wide-deployment-using-the-istio-injection-label.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources

* xref:../../install/ossm-sidecar-injection-assembly.adoc#ossm-identifying-revision-name_ossm-sidecar-injection-assembly[Identifying the revision name]

include::modules/ossm-migrating-workloads-using-the-istio-injection-label.adoc[leveloffset=+2]

.Next steps

If you are using gateways, you must migrate them before you complete the migration process.

* xref:../../migrating/migrating-gateways/ossm-migrating-gateways-assembly.adoc[Migrating gateways from Service Mesh 2 to Service Mesh 3]

If you are not using gateways, and have verified your cluster-wide migration, create a default revision tag and re-label namespaces.

[IMPORTANT]
====
Before creating a default revision tag and relabelling the namespaces, you must migrate all remaining workload namespaces, including gateways.
====

// insert xref to "Creating the default revision tag and relabeling the namespaces" after PR OSSM-9000 is merged

* Creating the default revision tag and relabeling the namespaces
